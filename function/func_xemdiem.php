<?phpfunction export_hs($result, $db_info) {	global $tpl, $db_id;		$tpl->assign('db_name', "{$db_info['name']} năm học {$db_info['year']} [{$db_info['comment']}]");	$subject_arr = explode('|', $db_info['subject']);	$hsnamelist = null;		for ($i = 0; $i <= (count($result)-1); $i++) {		$tpl->assign('db_name', "{$db_info['name']} năm học {$db_info['year']} [{$db_info['comment']}]");				$tpl->assign('hsname', standard_name($result[$i][1]));		$tpl->assign('class', $result[$i][2]);				$tpl->assign('sbd', $result[$i][0]);				$hsnamelist .= standard_name($result[$i][1]).' '.$result[$i][2].' - ';				$s_step = 3;				foreach ($subject_arr as $sub) {			$tpl->set_autoreset();						$tpl->assign('subject_name', $sub);			if ($result[$i][$s_step] == null) {				$tpl->parse('main.output_hs.hstable.subject.empty_point');			} else {				$tpl->assign('subject_point', $result[$i][$s_step]);				$tpl->assign('subject_exam_code', $result[$i][$s_step+1]);								$tpl->parse('main.output_hs.hstable.subject.point');			}			$s_step = $s_step + 2;			$tpl->parse('main.output_hs.hstable.subject');		}				$tpl->parse('main.output_hs.hstable');	}		$tpl->assign('db_id', $db_id);		//Xóa kí tự " - " ở cuối chuỗi	$hsnamelist .= '*';	$hsnamelist = str_replace(' - *', null, $hsnamelist);		$tpl->assign('dynamic_title', '- '.$hsnamelist.' - '.$db_info['name'].' ['.$db_info['comment'].']');			$tpl->assign('fb_link', SITE.'link.php?link='.base64_encode($_SERVER['REQUEST_URI']));	$tpl->assign('fb_title', 'PHPPV - '.$db_info['name'].' ['.$db_info['comment'].'] năm học '.$db_info['year']);	$tpl->assign('fb_descr', 'Xem điểm của học sinh: '.$hsnamelist);		$tpl->parse('main.output_hs');}function export_class($result, $db_info) {	global $tpl, $class;		$subject_arr = explode('|', $db_info['subject']);	$tpl->assign('db_name', "{$db_info['name']} năm học {$db_info['year']} [{$db_info['comment']}]");	$tpl->assign('class', $class);	$tpl->assign('count_hs', count($result));		for ($i = 0; $i <= count($subject_arr)-1; $i++) {		$tpl->set_autoreset();				$tpl->assign('subject', $subject_arr[$i]);		$tpl->parse('main.output_class.table_header');		}		$green_point = 0;	$red_point = 0;	$dtb_green_point = 0;	$dtb_red_point = 0;	$class_dtb = 0;		for ($i = 0; $i <= count($result)-1; $i++) {		$tpl->set_autoreset();				$tpl->assign('STT', $i+1);		$tpl->assign('hsname', standard_name($result[$i][1]));		//$tpl->assign('class', $result[$i][2]);		$tpl->assign('sbd', $result[$i][0]);				$k = 3;		$dtb = 0;		for ($j = 0; $j <= count($subject_arr)-1; $j++) {			$tpl->set_autoreset();						if ($result[$i][$k] == 0) {				$tpl->assign('subject_point', null);			} elseif ($result[$i][$k] >= 8) {				$tpl->assign('subject_point', '<span class="high_point">'.number_format($result[$i][$k], 1).'</span>');		$green_point++;			} elseif ($result[$i][$k] < 5) {				$tpl->assign('subject_point', '<span class="low_point">'.number_format($result[$i][$k], 1).'</span>');		$red_point++;			} else {				$tpl->assign('subject_point', number_format($result[$i][$k], 1));			}						$dtb = $dtb + $result[$i][$k];				$class_dtb = $class_dtb + $result[$i][$k];						if ($result[$i][$k] == 0) {				$tpl->assign('subject_exam_code', null);			} else {				$tpl->assign('subject_exam_code', $result[$i][$k+1]);			}						$k = $k+2;			$tpl->parse('main.output_class.table_body.table_body_point');		}				$dtb = round($dtb/count($subject_arr), 2);		$dtb = number_format($dtb, 2);				if ($dtb == 0) {			$tpl->assign('dtb', null);		} elseif ($dtb >= 8) {			$tpl->assign('dtb', '<span class="high_point">'.$dtb.'</span>');	$dtb_green_point++;		} elseif ($dtb < 5) {			$tpl->assign('dtb', '<span class="low_point">'.$dtb.'</span>');		$dtb_red_point++;		} else {			$tpl->assign('dtb', $dtb);		}				$tpl->parse('main.output_class.table_body');	}	$tpl->assign('green_point', $green_point);	$tpl->assign('red_point', $red_point);	$tpl->assign('dtb_green_point', $dtb_green_point);	$tpl->assign('dtb_red_point', $dtb_red_point);	$tpl->assign('class_dtb', round($class_dtb/(count($result)*4), 4));		$tpl->assign('dynamic_title', '- Xem điểm lớp '.$class.' - '.$db_info['name'].' ['.$db_info['comment'].'] năm học '.$db_info['year']);		$tpl->assign('fb_link', SITE.'link.php?link='.base64_encode($_SERVER['REQUEST_URI']));	$tpl->assign('fb_title', 'PHPPV - Xem điểm lớp '.$class);	$tpl->assign('fb_descr', 'Cơ sở dữ liệu: '.$db_info['name'].' ['.$db_info['comment'].'] năm học '.$db_info['year']);					$tpl->parse('main.output_class');}?>